<?xml version="1.0" encoding="utf-8"?>

<odoo>
  <data>
  
  <!-- dispatching filter view  -->
	<record model="ir.ui.view" id="oscar_dispatching_view_search">
	  <field name="name">oscar.dispatching.view.search</field>
	  <field name="model">oscar.dispatching</field>
	  <field name="arch" type="xml">
	    <search string="Rechercher des magasins">
	    	<filter string="Magasin dispatché" name="not_expired_magasin" domain="[('end_date', '>=', datetime.datetime.now().strftime('%Y-%m-%d'))]"/>
	    	<filter string="Date de début" name="group_by_start_date" context="{'group_by':'start_date'}"/>
	    </search>
	  </field>
	</record>
  	
  	<!-- dispatching form view  -->
  	<record model="ir.ui.view" id="oscar_dispatching_view_form">
	    <field name="name">oscar.dispatching.view.form</field>
	    <field name="model">oscar.dispatching</field>
	    <field name="arch" type="xml">
	      <form>
			<sheet>
				<group>
					<group>
						<field name="magasin_id" options="{'no_create': True, 'no_create_edit': True, 'no_open': True}" />
						<field name="controller_id" options="{'no_create': True, 'no_create_edit': True, 'no_open': True}" />
						<field name="controller_tr_id" options="{'no_create': True, 'no_create_edit': True, 'no_open': True}" />
					</group>
					<group>
						<field name="start_date"/>
						<field name="end_date"/>
						<field name="comment" />
				 	</group>
				</group>
			</sheet>
			<div class="oe_chatter">
				<field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
				<field name="message_ids" widget="mail_thread"/>
			</div>
	      </form>
	    </field>
	</record>
	
  	<!-- dispatching tree view  -->
	<record model="ir.ui.view" id="oscar_dispatching_view_tree">
	  <field name="name">oscar.dispatching.view.tree</field>
	  <field name="model">oscar.dispatching</field>
	  <field name="arch" type="xml">
	    <tree editable="top" >
			<field name="magasin_id" options="{'no_create': True, 'no_create_edit': True, 'no_open': True}" />
			<field name="controller_id" options="{'no_create': True, 'no_create_edit': True, 'no_open': True}" />
			<field name="controller_tr_id" options="{'no_create': True, 'no_create_edit': True, 'no_open': True}" />
			<field name="start_date"/>
			<field name="end_date"/>
			<field name="comment" />
	    </tree>
	  </field>
	</record>
	
  	<!-- actions liste des dispatching -->
    <record model="ir.actions.act_window" id="action_oscar_dispatching">
      <field name="type">ir.actions.act_window</field>
      <field name="name">Liste des dispatching</field>
      <field name="res_model">oscar.dispatching</field>
      <field name="view_mode">tree</field>
    </record>
    
    <!-- menu parametres de dispatching -->
	<menuitem name="Paramètres de dispatching" id="menu_parametre_dispatching_journee"
			sequence="350" parent="menu_oscar_recette" action="spc_recette_aziza.action_oscar_dispatching"
			groups="spc_recette_aziza.group_agent_reception_oscar,spc_recette_aziza.group_consulting_oscar" />
  
  </data>
</odoo>